

### 12-客户端sdk-paho

```
    <dependency>
      <groupId>org.eclipse.paho</groupId>
      <artifactId>org.eclipse.paho.client.mqttv3</artifactId>
      <version>1.2.5</version>
    </dependency>
```
1. MqttAsyncClient提供了一个完全异步的API，通过注册的回调通知。
2. MqttClient是MqttAsyncClient周转的同步包装器。


### 13
```


Mqtt
option.setUserName("");
option.setPassword("");

client.setCallback(xxx);
client.connect();

@preDestory
在程序退出之前，提前断开连接
clienct.disConnect();

重连

retain：是否是保留消息

发布消息
MqttMessage mqttMessage=new MqttMessage();
.setPayload("xx".getBytes());
.setQos(0);
.setRetained(true);
clienct.publishi(topic,mqttMessage)

订阅消息
client.subscribe(toppicFilter,qos));

取消订阅
client.unsubscribe(topicFilter);
```
### 16
```
回调方法
messageCallback implements MqttCallback

客户端下线 触发的方法
connectionLost(){
    //重连
    //释放资源等
}

收到消息的方法  同步方法
messageArrived(topic,mqttMessage){

}

消息发布完成
deliveryComplete(token){
    token.getMessage();
}


```

### 22-日志与追踪
```

/etc/emqx/emqx.cnf
log.to-both
* off：关闭
* file：文件
* console：控制台
* both：文件+控制台

log.level=info
debug<info<notice<warning<error<critical<alert<emergency

log.rotation.count=5
emqx.log.N++：日志文件 10M 切换文件
emqx.log.idx：日志流滚动系统文件

```

### 22-日志追踪
动态设备日志级别
emqx_ctl log primary-level debug

追踪指定客户端日志到文件
emqx_ctl trace start client xxxxx log/xxx.log